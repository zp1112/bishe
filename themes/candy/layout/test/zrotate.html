<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">

        path{
            fill:none;
            stroke: #000;
            stroke-width: 2px;
        }
        .domain,.tick line{
            stroke: #1ea622;
            stroke-width: 2px;
        }
    </style>
</head>
<body>
<div id="container"></div>
<script src="../../../../d3.v3.min.js"></script>
<script type="text/javascript">
//    var url="http://xxx.xx.json&callback=handler";
//    var script=document.createElement("script");
//    script.src=url;
//    document.getElementsByTagName("head")[0].appendChild(script);
//    var handler= function (data) {
//        var parse_data=d3.time.format("%Y-%m-%d").parse;
//        data.forEach(function () {
//
//        })
//    };
    d3.csv("data.csv", type,function (data) {

    var     width=1000,//柱形图宽度
            height=500,//柱形图高度
            margin={left:30,right:30,top:30,bottom:30},//放置坐标轴
            svg_width=width+margin.left+margin.right,//外部容器宽度
            svg_height=height+margin.top+margin.bottom;//外部容器高度

    var scale=d3.scale.linear()
            .domain([0,d3.max(data,function(d){return d.population;})])
            .range([height,0]);//Y轴方向上的线性缩放

    var scale_x=d3.scale.ordinal()
            .domain(data.map(function (d) {
                return d.year;
            }))//取出data里面数据
            .rangeBands([0,width],0.1);//X轴方向上的缩放

    var svg=d3.select("#container")
            .append("svg")
            .attr("width",svg_width)
            .attr("height",svg_height);

    var chart=svg.append("g")
            .attr("transform","translate("+margin.left+","+margin.top+")");

    var x_axis=d3.svg.axis().scale(scale_x);
    var y_axis=d3.svg.axis().scale(scale).orient("left");



    var bar=chart.selectAll("g")
            .data(data)//绑定数据
            .enter()//多出来的数据
            .append("g")
            .attr("transform",function(d,i){return "translate("+scale_x(d.year)+",0)";});
    chart.append("g")
            .call(x_axis)
            .attr("transform","translate(0,"+height+")");
    chart.append("g")
            .call(y_axis);
    bar.append("rect")//X轴显示年份
            .attr({
                "y": function (d) {
                    return scale(d.population);
                },
                "height":function(d){return height-scale(d.population)},
                "width":scale_x.rangeBand()
            })
            .style("fill","#ddd");

    bar.append("text")
            .text(function(d){return d.population})
            .attr({
                "y":function(d){return scale(d.population)},
                "x":scale_x.rangeBand()/2,
                "dy":15,
                "text-anchor":"middle"
            })
    });
    function type(d){
        d.population=+d.population;//把字符串转换成数值形式
        d.year=+d.year;
        return d;
    }
</script>

</body>
</html>